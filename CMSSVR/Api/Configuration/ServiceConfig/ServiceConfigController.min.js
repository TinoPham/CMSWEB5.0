define(["require","App"],function(n,t){var i=function(n,t,i,r,u,f){function o(i){t.model=i;n.isPaneShown=!1;t.lastmodel=angular.copy(t.model)}function e(n){t.ReadOnly=n;t.btnSave=t.ReadOnly?t.Resx.str_Edit:t.Resx.str_Save}t.model={MatchAllinfo:!0,DVRAuths:null};t.lastmodel=angular.copy(t.model);t.allow_up=!1;t.allow_down=!1;t.Selected=null;t.ReadOnly=!0;t.Resx={str_Save:"Save",str_Cancel:"Cancel",str_Edit:"Edit"};t.btnSave=t.Resx.str_Edit;t.dirtyMatch=!1;t.$watch("model.DVRAuths",function(n){if(n!=null&&angular.isDefined(n)){var i=n.filter(function(n){return n.Checked==!0});t.dirtyMatch=i.length>0?!1:!0}},!0);t.loadconfig=function(){n.isPaneShown=!0;t.dirtyMatch=!1;f.GetDVRAuthConfig().then(function(n){o(n);e(!0)},function(t){n.isPaneShown=!1;u.error(t)},function(t){n.isPaneShown=!1;u.error(t)})};t.setSelected=function(n){t.Selected=n;var r=t.model.DVRAuths,i=$.inArray(n,r);t.allow_up=!1;t.allow_down=!1;i>=0&&i<r.length-1&&(t.allow_down=!0);i>0&&(t.allow_up=!0)};t.moveUpDown=function(n){if(t.Selected!=null){var i=t.model.DVRAuths,r=$.inArray(t.Selected,i),u=i[r+1*n];i[r+1*n]=t.Selected;i[r]=u;t.setSelected(t.Selected)}};t.CancelEdit=function(){t.model=angular.copy(t.lastmodel);t.btnSave=t.Resx.str_Edit;e(!0);t.dirtyMatch=!1};t.SaveEdit=function(){t.ReadOnly?e(!1):t.dirtyMatch==!1&&t.config.$valid&&(n.isPaneShown=!0,f.SetDVRAuthConfig(t.model).then(function(n){o(n);e(!0)},function(t){u.error(t);n.isPaneShown=!1},function(t){u.error(t);n.isPaneShown=!1}))}};i.$inject=["$rootScope","$scope","$state","$stateParams","Dialogs","ApiService"];t.register.controller("svrconfig",i)});