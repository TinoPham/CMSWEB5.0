(function(n){"use strict";function t(n){return parseInt(n.replace(/px|%/,""),10)}n.module("scrollable-table",[]).directive("scrollabletable",["$timeout","$q","$parse",function(i,r,u){return{transclude:!0,restrict:"E",scope:{rows:"=watch",sortFn:"="},template:'<div class="scrollableContainer"><div class="headerSpacer"><\/div><div class="scrollArea" ng-transclude><\/div><\/div>',controller:["$scope","$element","$attrs",function(f,e,o){function a(n,t){var i=f.sortExpr.match(/(.+)\s+as\s+(.+)/),r={},e,o;return(r[i[1]]=n,e=u(i[2])(r),r[i[1]]=t,o=u(i[2])(r),e===o)?0:e>o?1:-1}function v(n){var t=e.find(".headerSpacer").height(),i=e.find(".scrollArea").scrollTop();e.find(".scrollArea").scrollTop(i+n.position().top-t)}function s(){function t(){e.find("table:visible").length===0?i(t,100):n.resolve()}var n=r.defer();return i(t),n.promise}function c(){e.find("thead th .th-inner").length||e.find("thead th").wrapInner('<div class="th-inner"><\/div>');var i=1;e.find("table th .th-inner").each(function(r,u){var l,a,c,s;u=n.element(u);var f=u.parent().width(),h=e.find("table th:visible:last"),o=f;f=u.parent().css("width");/\d+px$/.test(f)&&(l=/(\d+)px$/.exec(f),f=parseInt(l[1]));o=f;h.css("text-align")!=="center"&&(a=e.find(".scrollArea").height()<e.find("table").height(),h[0]==u.parent()[0]&&a&&(o+=e.find(".scrollArea").width()-e.find("tbody tr").width(),o=Math.max(o,f)));c=t(u.parent().css("min-width"));s=u.parent().attr("title");f=Math.max(c,f);o=Math.max(c,o);u.css("width",o);s||(s=u.children().length?u.find(".title .ng-scope").html():u.html());u.attr("title",s.trim());h[0]!=u.parent()[0]&&u.parent().css("width",f);u.css("left",i);i+=f});h.resolve()}function l(i){var r=e.find("table th:last"),u=e.find("table th").length;e.find("table th").each(function(f,e){var o,s;(e=n.element(e),r.get(0)!=e.get(0))&&(o=e.css("width"),/\d+%$/.test(o)?o=Math.ceil(i*t(o)/100):/\d+px$/.test(o)?(s=/(\d+)px$/.exec(o),o=s[1]):o=i/u,e.css("width",o+"px"))});s().then(c)}this.getSortExpr=function(){return f.sortExpr};this.isAsc=function(){return f.asc};this.setSortExpr=function(n){f.asc=!0;f.sortExpr=n};this.toggleSort=function(){f.asc=!f.asc};this.doSort=function(n){n?f.rows.sort(function(t,i){var r=n(t,i);return f.asc?r:r*-1}):f.rows.sort(function(n,t){var i=a(n,t);return f.asc?i:i*-1})};this.resizeColumn=function(){c()};f.$on("rowSelected",function(n,t){var i=e.find(".scrollArea table tr[row-id='"+t+"']");i.length===1&&r.all([s(),h.promise]).then(function(){v(i)})});var h=r.defer();n.element(window).on("resize",function(){f.$apply()});f.$watch(function(){return e.find(".scrollArea").width()},function(n,t){var i=n,r=t;i*r!=0&&l(i)});f.$watch("rows",function(n){n&&(f.sortExpr=null,e.find(".scrollArea").scrollTop(0),l(e.find(".scrollArea").width()))});f.asc=!o.hasOwnProperty("desc");f.sortAttr=o.sortAttr;e.find(".scrollArea").scroll(function(n){e.find("thead th .th-inner").css("margin-left",0-n.target.scrollLeft)})}]}}]).directive("sortableheader",[function(){return{transclude:!0,scope:!0,require:"^scrollabletable",template:'<div class="box"><div ng-mouseenter="enter()" ng-mouseleave="leave()"><div class="title" ng-transclude><\/div><span class="orderWrapper"><span class="order" ng-show="focused || isActive()" ng-click="toggleSort($event)" ng-class="{active:isActive()}"><i ng-show="isAscending()" class="glyphicon icon-arrow-down-5"><\/i><i ng-show="!isAscending()" class="glyphicon icon-arrow-up-5"><\/i><\/span><\/span><\/div><div class="resize-rod" ng-mousedown="resizing($event)"><\/div><\/div>',link:function(i,r,u,f){var e=u.on||"a as a."+u.col;i.element=n.element(r);i.isActive=function(){var n=f.getSortExpr();return n===null||n==undefined?!1:n===e};i.toggleSort=function(n){i.isActive()?f.toggleSort():f.setSortExpr(e);f.doSort(i[u.comparatorFn]);n.preventDefault()};i.isAscending=function(){return i.focused&&!i.isActive()?!0:f.isAsc()};i.enter=function(){i.focused=!0};i.leave=function(){i.focused=!1};i.resizing=function(r){var o=t(i.element.children().css("left"))+i.element.children().width(),s=r.pageX,e=n.element(document),h=n.element("body"),c=n.element(".scrollableContainer .resizing-cover"),u=n.element('<div class="scaler">');h.addClass("scrollable-resizing");c.addClass("active");n.element(".scrollableContainer").append(u);u.css("left",o);e.bind("mousemove",function(n){var r=n.pageX-s,f=t(u.css("left"))-o,e=i.element.width(),h=t(i.element.css("min-width")),c=i.element.next().width(),l=t(i.element.next().css("min-width"));(s=n.pageX,n.preventDefault(),r>0&&c-f<=l||r<0&&e+f<=h)||u.css("left",t(u.css("left"))+r)});e.bind("mouseup",function(n){n.preventDefault();u.remove();h.removeClass("scrollable-resizing");c.removeClass("active");e.unbind("mousemove");e.unbind("mouseup");var r=t(u.css("left"))-o,s=i.element.width(),v=t(i.element.css("min-width")),l=i.element.next().width(),a=t(i.element.next().css("min-width"));r>0&&l-r<=a&&(r=l-a);i.element.next().removeAttr("style");s+=r;i.element.css("width",Math.max(v,s));f.resizeColumn()})}}}}])})(angular);
/*
//# sourceMappingURL=angular-scrollable-table.min.js.map
*/