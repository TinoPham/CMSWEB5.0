(function(){"use strict";angular.module("ui.tree",[]).constant("treeConfig",{treeClass:"angular-ui-tree",emptyTreeClass:"angular-ui-tree-empty",hiddenClass:"angular-ui-tree-hidden",nodesClass:"angular-ui-tree-nodes",nodeClass:"angular-ui-tree-node",handleClass:"angular-ui-tree-handle",placeHoldersWrapperClass:"angular-ui-tree-placeholders-wrapper",placeHolderClass:"angular-ui-tree-placeholder",dragClass:"angular-ui-tree-drag",dragWrapperClass:"angular-ui-tree-drag-wrapper",dragUpThreshold:10,levelThreshold:30}).constant("keys",{space:32,enter:13,tab:9,esc:27,escape:27,backspace:8,back:8,shift:16,maj:16,ctrl:17,control:17,alt:18,left:37,leftarrow:37,up:38,uparrow:38,right:39,rightarrow:39,down:40,downarrow:40,ins:45,insert:45,del:46,"delete":46,home:36,end:35,pgup:33,pageup:33,pgdown:34,pagedown:34,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123})})(),function(){"use strict";angular.module("ui.tree").factory("$uiTreeHelper",["$document","$window",function(n,t){return{nodesData:{},setNodeAttribute:function(n,t,i){if(!n.$modelValue)return undefined;var r=this.nodesData[n.$modelValue.$$hashKey];r||(r={},this.nodesData[n.$modelValue.$$hashKey]=r);r[t]=i},getNodeAttribute:function(n,t){if(!n.$modelValue)return undefined;var i=this.nodesData[n.$modelValue.$$hashKey];return i?i[t]:undefined},nodrag:function(n){return typeof n.attr("nodrag")!="undefined"},eventObj:function(n){var t=n;return n.targetTouches!==undefined?t=n.targetTouches.item(0):n.originalEvent!==undefined&&n.originalEvent.targetTouches!==undefined&&(t=n.originalEvent.targetTouches.item(0)),t},dragInfo:function(n){return angular.isDefined(n)?{source:n,sourceInfo:{nodeScope:n,index:angular.isFunction(n.index)?n.index():0,nodesScope:n.$parentNodesScope},index:angular.isFunction(n.index)?n.index():0,siblings:angular.isFunction(n.siblings)?n.siblings().slice(0):[],parent:n.$parentNodesScope,moveTo:function(t,i,r){if(t.accept(n,r)===!0){this.parent=t;this.siblings=i.slice(0);var u=this.siblings.indexOf(this.source);return u>-1&&(this.siblings.splice(u,1),this.source.index()<r&&r--),this.siblings.splice(r,0,this.source),this.index=r,!0}return!1},parentNode:function(){return this.parent.$nodeScope},prev:function(){return this.index>0?this.siblings[this.index-1]:undefined},next:function(){return this.index<this.siblings.length-1?this.siblings[this.index+1]:undefined},isDirty:function(){return this.source.$parentNodesScope!=this.parent||this.source.index()!=this.index},eventArgs:function(n,t){return{source:this.sourceInfo,dest:{index:this.index,nodesScope:this.parent},elements:n,pos:t}},apply:function(n){var i=this.source.$modelValue,r,t;n||this.source.remove();angular.isDefined(this.parent)&&(r=n?angular.copy(i):i,t=this.index,n&&this.sourceInfo.index<this.index&&this.sourceInfo.nodesScope===this.parent&&(t=this.index+1),this.parent.insertNode(t,r))}}:undefined},height:function(n){return n.prop("scrollHeight")},width:function(n){return n.prop("scrollWidth")},offset:function(i){var r=i[0].getBoundingClientRect();return{width:i.prop("offsetWidth"),height:i.prop("offsetHeight"),top:r.top+(t.pageYOffset||n[0].body.scrollTop||n[0].documentElement.scrollTop),left:r.left+(t.pageXOffset||n[0].body.scrollLeft||n[0].documentElement.scrollLeft)}},positionStarted:function(n,t){var i={};return i.offsetX=n.pageX-this.offset(t).left,i.offsetY=n.pageY-this.offset(t).top,i.startX=i.lastX=n.pageX,i.startY=i.lastY=n.pageY,i.nowX=i.nowY=i.distX=i.distY=i.dirAx=0,i.dirX=i.dirY=i.lastDirX=i.lastDirY=i.distAxX=i.distAxY=0,i},positionMoved:function(n,t,i){t.lastX=t.nowX;t.lastY=t.nowY;t.nowX=n.pageX;t.nowY=n.pageY;t.distX=t.nowX-t.lastX;t.distY=t.nowY-t.lastY;t.lastDirX=t.dirX;t.lastDirY=t.dirY;t.dirX=t.distX===0?0:t.distX>0?1:-1;t.dirY=t.distY===0?0:t.distY>0?1:-1;var r=Math.abs(t.distX)>Math.abs(t.distY)?1:0;if(i){t.dirAx=r;t.moving=!0;return}t.dirAx!==r?(t.distAxX=0,t.distAxY=0):(t.distAxX+=Math.abs(t.distX),t.dirX!==0&&t.dirX!==t.lastDirX&&(t.distAxX=0),t.distAxY+=Math.abs(t.distY),t.dirY!==0&&t.dirY!==t.lastDirY&&(t.distAxY=0));t.dirAx=r},findIntersect:function(n,t,i,r,u){for(var a,o,e,f,v,c,l=this,s,h=0;h<t.length;h++)if(o=angular.element(t[h]),angular.isDefined(o[0])&&(o.hasClass("angular-ui-tree-node")?(a=l.findIntersect(n,o.children(),i,r,u),angular.isUndefined(a)?(e=l.offset(o),f={left:e.left,width:e.width,right:e.left+e.width,top:e.top,height:e.height,bottom:e.top+e.height},u&&(r<0?v=i==="bottom"?n.left<=f.right&&n.right>=f.left:n.right<=f.right&&n.right>=f.left:r>0&&(v=i==="bottom"?n.right>=f.left&&n.left<=f.right:n.left>=f.left&&n.left<=f.right)),r<0?c=i==="bottom"?n.top<=f.bottom&&n.bottom>=f.top:n.bottom<=f.bottom&&n.bottom>=f.top:r>0&&(c=i==="bottom"?n.bottom>=f.top&&n.top<=f.bottom:n.top>=f.top&&n.top<=f.bottom),(u&&v&&c||!u&&c)&&(s=t[h])):s=a):angular.isDefined(o.children())&&o.children().length>0&&(s=l.findIntersect(n,o.children(),i,r,u))),angular.isDefined(s))break;return s}}}])}(),function(){"use strict";angular.module("ui.tree").controller("TreeController",["$scope","$element","$window","$attrs","treeConfig","keys",function(n,t,i,r,u,f){this.scope=n;n.$element=t;n.$treeElement=t;n.$nodesScope=undefined;n.$type="uiTree";n.$emptyElm=undefined;n.$callbacks=undefined;n.$selecteds=[];n.dragEnabled=angular.isUndefined(n.dragEnabled)?!0:n.dragEnabled;n.emptyPlaceholderEnabled=angular.isUndefined(n.emptyPlaceholderEnabled)?!1:n.emptyPlaceholderEnabled;n.maxDepth=angular.isUndefined(n.maxDepth)?10:n.maxDepth;n.dragDelay=angular.isUndefined(n.dragDelay)?0:n.dragDelay;n.dragDistance=angular.isUndefined(n.dragDistance)?0:n.dragDistance;n.cancelKey=f.escape;n.lockXKey=undefined;n.lockX=!1;n.lockYKey=undefined;n.lockY=!1;n.boundTo=angular.isUndefined(n.boundTo)?"":n.boundTo;n.collideWith="bottom";n.coverage=.5;n.spacing=angular.isUndefined(n.spacing)?50:n.spacing;n.spacingThreshold=Math.floor(n.spacing/4);n.copyKey=undefined;n.copy=!1;n.multiSelectKey=undefined;n.multiSelect=!1;n.expandOnHover=angular.isUndefined(n.expandOnHover)?500:n.expandOnHover;n.$watch("callbacks",function(t){angular.forEach(t,function(t,i){n.$callbacks[i]&&angular.isFunction(t)&&(n.$callbacks[i]=t)})},!0);n.$watch("$nodesScope.$modelValue.length",function(t){typeof t!="undefined"&&n.$nodesScope.$modelValue&&n.resetEmptyElement()},!0);n.$watch("lockXKeyString",function(t){angular.isString(t)&&(t=t.toLowerCase(),t.length>0&&(n.lockXKey=angular.isDefined(f[t])?f[t]:t.length===1?t.charCodeAt(0)-32:undefined));n.lockX=angular.isUndefined(n.lockXKey)&&typeof t=="boolean"?t:!1});n.$watch("lockYKeyString",function(t){angular.isString(t)&&(t=t.toLowerCase(),t.length>0&&(n.lockYKey=angular.isDefined(f[t])?f[t]:t.length===1?t.charCodeAt(0)-32:undefined));n.lockY=angular.isUndefined(n.lockXKey)&&typeof t=="boolean"?t:!1});n.$watch("boundToString",function(t){if(angular.isString(t)&&t.length>0)try{n.boundTo=angular.element(i.document.querySelectorAll(t))}catch(r){n.boundTo=""}});n.$watch("spacing",function(t){angular.isNumber(t)&&t>0&&(n.spacingThreshold=Math.floor(n.spacing/4))});n.$watch("coveragePercent",function(t){angular.isNumber(t)&&t>=-100&&t<=100&&(n.collideWith=t<0?"top":"bottom",n.coverage=Math.abs(t/100))});n.$watch("cancelKeyString",function(t){angular.isString(t)&&(t=t.toLowerCase(),t.length>0&&(n.cancelKey=angular.isDefined(f[t])?f[t]:t.charCodeAt(0)-32))});n.$watch("copyKeyString",function(t){angular.isString(t)&&(t=t.toLowerCase(),t.length>0&&(n.copyKey=angular.isDefined(f[t])?f[t]:t.charCodeAt(0)-32))});n.$watch("selectKeyString",function(t){angular.isString(t)&&(t=t.toLowerCase(),t.length>0&&(n.multiSelectKey=angular.isDefined(f[t])?f[t]:t.charCodeAt(0)-32))});n.isEmpty=function(){return n.$nodesScope&&n.$nodesScope.$modelValue&&n.$nodesScope.$modelValue.length===0};n.place=function(t){n.$nodesScope.$element.append(t);n.$emptyElm.remove()};n.resetEmptyElement=function(){n.$nodesScope.$modelValue.length===0&&n.emptyPlaceholderEnabled?t.append(n.$emptyElm):n.$emptyElm.remove()};var e=function(n,t){for(var u,r=n.childNodes(),i=0;i<r.length;i++)r[i]&&(t?r[i].collapse(!0):r[i].expand(!0),u=r[i].$childNodesScope,u&&e(u,t))};n.collapseAll=function(){e(n.$nodesScope,!0)};n.$on("collapseAll",n.collapseAll);n.expandAll=function(){e(n.$nodesScope,!1)};n.$on("expandAll",n.expandAll)}])}(),function(){"use strict";angular.module("ui.tree").controller("TreeNodesController",["$scope","$element","$q","treeConfig",function(n,t,i){this.scope=n;n.$element=t;n.$nodesElement=t;n.$modelValue=undefined;n.$nodeScope=undefined;n.$treeScope=undefined;n.$type="uiTreeNodes";n.$nodesMap={};n.nodrop=!1;n.maxDepth=0;n.expandOnHover=undefined;n.initSubNode=function(t){if(!t.$modelValue)return undefined;n.$nodesMap[t.$modelValue.$$hashKey]=t};n.destroySubNode=function(t){if(!t.$modelValue)return undefined;n.$nodesMap[t.$modelValue.$$hashKey]=undefined};n.accept=function(t,i){return n.$treeScope.$callbacks.accept(t,n,i)};n.beforeDrag=function(t,i){return n.$treeScope.$callbacks.beforeDrag(t,i)};n.isParent=function(t){return t.$parentNodesScope==n};n.hasChild=function(){return n.$modelValue.length>0};n.safeApply=function(n){var t=this.$root.$$phase;t=="$apply"||t=="$digest"?n&&typeof n=="function"&&n():this.$apply(n)};n.removeNode=function(t){var r=i.defer(),u=n.$modelValue.indexOf(t.$modelValue);return u>-1?n.safeApply(function(){n.$modelValue.splice(u,1)[0];r.resolve(t)}):r.reject("not found"),r.promise};n.insertNode=function(t,r){var u=i.defer();return n.safeApply(function(){n.$modelValue.splice(t,0,r);u.resolve("inserted")}),u.promise};n.childNodes=function(){var i=[],t;if(n.$modelValue)for(t=0;t<n.$modelValue.length;t++)i.push(n.$nodesMap[n.$modelValue[t].$$hashKey]);return i};n.depth=function(){return n.$nodeScope?n.$nodeScope.depth():0};n.outOfDepth=function(t){var i=n.maxDepth||n.$treeScope.maxDepth;return i>0?n.depth()+t.maxSubDepth()+1>i:!1}}])}(),function(){"use strict";angular.module("ui.tree").controller("TreeNodeController",["$scope","$element","$attrs","treeConfig",function(n,t){this.scope=n;n.$element=t;n.$nodeElement=t;n.$modelValue=undefined;n.$parentNodeScope=undefined;n.$childNodesScope=undefined;n.$parentNodesScope=undefined;n.$treeScope=undefined;n.$handleScope=undefined;n.$type="uiTreeNode";n.$$apply=!1;n.$dragInfo=undefined;n.collapsed=!1;n.expandOnHover=!1;n.selected=!1;n.init=function(i){var r=i[0];n.$treeScope=i[1]?i[1].scope:undefined;n.$parentNodeScope=r.scope.$nodeScope;n.$modelValue=r.scope.$modelValue[n.$index];n.$parentNodesScope=r.scope;r.scope.initSubNode(n);t.on("$destroy",function(){r.scope.destroySubNode(n)})};n.toggleSelected=function(){n.selected?n.unselect():n.select()};n.select=function(){!n.selected&&n.$treeScope.$callbacks.select(n)&&(n.selected=!0,n.$treeScope.$selecteds.push(n.$element))};n.unselect=function(){if(n.selected&&n.$treeScope.$callbacks.unselect(n)){n.selected=!1;var t=n.$treeScope.$selecteds.indexOf(n.$element);angular.isDefined(t)&&t>-1&&n.$treeScope.$selecteds.splice(t,1)}};n.index=function(){return n.$parentNodesScope.$modelValue.indexOf(n.$modelValue)};n.dragEnabled=function(){return!(n.$treeScope&&!n.$treeScope.dragEnabled)};n.isSibling=function(t){return n.$parentNodesScope===t.$parentNodesScope};n.isChild=function(t){var i=n.childNodes();return i&&i.indexOf(t)>-1};n.prev=function(){var t=n.index();return t>0?n.siblings()[t-1]:undefined};n.siblings=function(){return n.$parentNodesScope.childNodes()};n.childNodesCount=function(){return angular.isDefined(n.childNodes())?n.childNodes().length:0};n.hasChild=function(){return n.childNodesCount()>0};n.childNodes=function(){return angular.isDefined(n.$childNodesScope)&&angular.isDefined(n.$childNodesScope.$modelValue)?n.$childNodesScope.childNodes():undefined};n.accept=function(t,i){return angular.isDefined(n.$childNodesScope)&&angular.isDefined(n.$childNodesScope.$modelValue)&&n.$childNodesScope.accept(t,i)};n.removeNode=function(){if(n.$treeScope.$callbacks.remove(t)){var t=n.remove();return t}return undefined};n.remove=function(){return n.$parentNodesScope.removeNode(n)};n.toggle=function(){n.collapsed=!n.collapsed};n.collapse=function(t){n.collapsed=n.$treeScope.$callbacks.collapse(n,t)};n.expand=function(t){n.collapsed=!n.$treeScope.$callbacks.expand(n,t)};n.depth=function(){var t=n.$parentNodeScope;return t?t.depth()+1:1};var i=0,r=function(n){for(var u,f=0,e=n.childNodes(),t=0;t<e.length;t++)u=e[t].$childNodesScope,u&&(f=1,r(u));i+=f};n.maxSubDepth=function(){return i=0,n.$childNodesScope&&r(n.$childNodesScope),i}}])}(),function(){"use strict";angular.module("ui.tree").controller("TreeHandleController",["$scope","$element","$attrs","treeConfig",function(n,t){this.scope=n;n.$element=t;n.$handleElement=t;n.$nodeScope=undefined;n.$type="uiTreeHandle"}])}(),function(){"use strict";angular.module("ui.tree").directive("uiTree",["treeConfig","keys","$window",function(n,t,i){return{restrict:"EA",scope:{callbacks:"=?",dragEnabled:"=?",emptyPlaceholderEnabled:"=?",maxDepth:"=?",dragDelay:"=?",dragDistance:"=?",lockXKeyString:"=?lockX",lockYKeyString:"=?lockY",boundToString:"=?boundTo",spacing:"=?",coveragePercent:"=?coverage",cancelKeyString:"=?cancelKey",copyKeyString:"=?copyKey",selectKeyString:"=?selectKey",expandOnHover:"=?"},controller:"TreeController",link:function(t,r){var u={accept:undefined,beforeDrag:undefined},f={};angular.extend(f,n);f.treeClass&&r.addClass(f.treeClass);t.$emptyElm=angular.element(i.document.createElement("div"));f.emptyTreeClass&&t.$emptyElm.addClass(f.emptyTreeClass);u.accept=function(n,t){return t.nodrop||t.outOfDepth(n)?!1:!0};u.collapse=function(){return!0};u.expand=function(){return!0};u.beforeDrag=function(){return!0};u.expandTimeoutStart=function(){};u.expandTimeoutCancel=function(){};u.expandTimeoutEnd=function(){return!0};u.remove=function(){return!0};u.dropped=function(){};u.droppedInto=function(){};u.dragStart=function(){};u.dragMove=function(){};u.placeholderMove=function(){};u.dragCancel=function(){};u.dragStop=function(){};u.beforeDrop=function(){return!0};u.lock=function(){return!0};u.unlock=function(){return!0};u.startCopy=function(){return!0};u.endCopy=function(){};u.startSelect=function(){return!0};u.select=function(){return!0};u.unselect=function(){return!0};u.endSelect=function(){};t.$callbacks=u}}}])}(),function(){"use strict";angular.module("ui.tree").directive("uiTreeNodes",["treeConfig",function(n){return{require:["ngModel","?^uiTreeNode","^uiTree"],restrict:"EA",scope:{maxDepth:"=?",expandOnHover:"=?",noDrop:"=?",horizontal:"=?"},controller:"TreeNodesController",link:function(t,i,r,u){var e={};angular.extend(e,n);e.nodesClass&&i.addClass(e.nodesClass);var f=u[0],o=u[1],s=u[2];o?(o.scope.$childNodesScope=t,t.$nodeScope=o.scope):s.scope.$nodesScope=t;t.$treeScope=s.scope;f&&(f.$render=function(){f.$modelValue&&angular.isArray(f.$modelValue)||(t.$modelValue=[]);t.$modelValue=f.$modelValue})}}}])}(),function(){"use strict";angular.module("ui.tree").directive("uiTreeNode",["treeConfig","$uiTreeHelper","$window","$document","$timeout","$filter",function(n,t,i,r,u,f){return{require:["^uiTreeNodes","^uiTree"],restrict:"EA",controller:"TreeNodeController",link:function(e,o,s,h){var v={};angular.extend(v,n);v.nodeClass&&o.addClass(v.nodeClass);e.init(h);e.collapsed=!!t.getNodeAttribute(e,"collapsed");e.$watch(s.collapsed,function(n){typeof n=="boolean"&&(e.collapsed=n)});e.$watch("collapsed",function(n){t.setNodeAttribute(e,"collapsed",n);s.$set("collapsed",n)});e.selected=!!t.getNodeAttribute(e,"selected");e.$watch(s.selected,function(n){typeof n=="boolean"&&(e.selected=n)});e.$watch("selected",function(n){t.setNodeAttribute(e,"selected",n);s.$set("selected",n)});e.$watch(s.expandOnHover,function(n){e.expandOnHover=n});var at="ontouchstart"in window,d,l,c,p,a,b,k,tt=!0,it=!1,ot,g=document.body,w=document.documentElement,rt,st,vt=function(n){n.preventDefault();n.stopPropagation();ct(e);ht(e)||e.$apply(e.toggleSelected)},ht=function(n,t){n=angular.isUndefined(n)?e:n;t=angular.isUndefined(t)?0:t;var i=!1;return n!==null&&(i=!1,!i&&angular.isDefined(n.$parent)&&(i=ht(n.$parent,t+1)),!i&&t>0&&(i=angular.isDefined(n.selected)?n.selected:!1)),i},ct=function(n){n=angular.isUndefined(n)?e:n;n.hasChild()&&angular.forEach(n.childNodes(),function(n){n.$apply(n.unselect);ct(n)})},yt=function(n){var f,u,i;e.$treeScope.dragDistance>0?(f=t.eventObj(n),l=t.positionStarted(f,e.$element),u=function(t){t.preventDefault();var f=Math.floor(Math.sqrt(Math.pow(t.pageX-l.startX,2)+Math.pow(t.pageY-l.startY,2)));f>=e.$treeScope.dragDistance&&(angular.element(r).unbind("touchmove",u),angular.element(r).unbind("mousemove",u),angular.element(r).unbind("touchend",i),angular.element(r).unbind("touchcancel",i),angular.element(r).unbind("mouseup",i),ut(n))},angular.element(r).bind("touchmove",u),angular.element(r).bind("mousemove",u),i=function(n){n.preventDefault();angular.element(r).unbind("touchmove",u);angular.element(r).unbind("mousemove",u);angular.element(r).unbind("touchend",i);angular.element(r).unbind("touchcancel",i);angular.element(r).unbind("mouseup",i);y(n)},angular.element(r).bind("touchend",i),angular.element(r).bind("touchcancel",i),angular.element(r).bind("mouseup",i)):ut(n)},ut=function(n,u){var ft,s,h,tt,ut,ot,b,it;if(e.$treeScope.dragEvent=angular.isDefined(n)&&!u?n:e.$treeScope.dragEvent,angular.isDefined(e.$treeScope.dragEvent)){if(ft=t.offset(e.$element),!at&&(e.$treeScope.dragEvent.button==2||e.$treeScope.dragEvent.which==3))return;if((e.$treeScope.dragEvent.uiTreeDragging||e.$treeScope.dragEvent.originalEvent&&e.$treeScope.dragEvent.originalEvent.uiTreeDragging)&&!u)return;if(s=angular.element(e.$treeScope.dragEvent.target),h=s.scope(),!h||!h.$type)return;if(h.$type!="uiTreeNode"&&h.$type!="uiTreeHandle")return;if(h.$type=="uiTreeNode"&&h.$handleScope)return;if(tt=s.prop("tagName").toLowerCase(),tt=="input"||tt=="textarea"||tt=="button"||tt=="select")return;while(s&&s[0]&&s[0]!=o){if(t.nodrag(s))return;s=s.parent()}if(!e.$parentNodesScope.beforeDrag(e,e.$treeScope.dragEvent)&&!u)return;e.$treeScope.dragEvent.uiTreeDragging=!0;e.$treeScope.dragEvent.originalEvent&&(e.$treeScope.dragEvent.originalEvent.uiTreeDragging=!0);e.$treeScope.dragEvent.preventDefault();i.getSelection?i.getSelection().removeAllRanges():i.document.selection&&i.document.selection.empty();ut=t.eventObj(e.$treeScope.dragEvent);u?angular.forEach(e.$treeScope.$selecteds,function(n){n=angular.element(n);e.$treeScope.copy?n.removeClass(v.hiddenClass):n.addClass(v.hiddenClass)}):(d=!0,(angular.isUndefined(e.$treeScope.$selecteds)||e.$treeScope.$selecteds.length===0)&&(e.$treeScope.$selecteds=[e.$element]),e.selected||(angular.forEach(e.$treeScope.$selecteds,function(n){var t=angular.element(n).scope();t.$apply(function(){t.selected=!1})}),e.$treeScope.$selecteds=[e.$element]),e.$treeScope.$selecteds.length>1&&(e.$treeScope.$selecteds=f("orderBy")(e.$treeScope.$selecteds,function(n){return t.offset(angular.element(n)).top},!1)),angular.isDefined(e.$treeScope.$selecteds)&&e.$treeScope.$selecteds.length>0&&(ot=[],c=angular.element(i.document.createElement("div")).addClass(v.placeHoldersWrapperClass),p=angular.element(i.document.createElement("div")),a=angular.element(i.document.createElement("div")).addClass(v.dragWrapperClass),l=t.positionStarted(ut,angular.element(e.$treeScope.$selecteds[0])),b=angular.element(e.$treeScope.$selecteds[0]),it=angular.copy(t.offset(b)),angular.forEach(e.$treeScope.$selecteds,function(n){var f=angular.element(n),u=f.scope(),w,l,h,b,y;u.$dragInfo=t.dragInfo(u);var k=t.height(f),d=t.width(f),o,s=f.prop("tagName");s.toLowerCase()==="tr"?(o=angular.element(i.document.createElement(s)),w=angular.element(i.document.createElement("td")).addClass(v.placeHolderClass),o.append(w)):o=angular.element(i.document.createElement(s)).addClass(v.placeHolderClass);o.css("height",k+"px");c.append(o);l=angular.element(i.document.createElement(s));v.hiddenClass&&l.addClass(v.hiddenClass);p.append(l);h=angular.element(i.document.createElement(u.$parentNodesScope.$element.prop("tagName"))).addClass(u.$parentNodesScope.$element.attr("class"));h.css("width",d+"px");b=f.clone();h.append(b);e.$treeScope.copy||f.addClass(v.hiddenClass);a.append(h);y=(e.$element[0].querySelector(".angular-ui-tree-handle")||e.$element[0]).currentStyle;y&&(document.body.setAttribute("ui-tree-cursor",r.find("body").css("cursor")||""),r.find("body").css({cursor:y.cursor+"!important"}));u.$apply(function(){u.selected=!1;u.original=!0})}),a.css("z-index",9999).addClass(v.dragClass),b.parent()[0].insertBefore(c[0],b[0]),b.parent()[0].insertBefore(p[0],b[0]),r.find("body").append(a),a.css({left:it.left+"px",top:it.top+"px"}),k={placeholder:c,dragging:a},angular.element(r).bind("touchend",y),angular.element(r).bind("touchcancel",y),angular.element(r).bind("touchmove",nt),angular.element(r).bind("mouseup",y),angular.element(r).bind("mousemove",nt),angular.element(r).bind("mouseleave",et)),rt=Math.max(g.scrollHeight,g.offsetHeight,w.clientHeight,w.scrollHeight,w.offsetHeight),st=Math.max(g.scrollWidth,g.offsetWidth,w.clientWidth,w.scrollWidth,w.offsetWidth))}},lt=function(n){n.preventDefault();e.$treeScope.$selecteds.length>0&&ut(undefined,!0)},pt=function(n){var ht,ct,wt,bt,kt,dt,ii,ri,ui,r,g,vt,gt,y,h,ft,fi,lt,ei,ni,oi,si,nt,pt,ti,hi,li,ai;if(!it){tt||(it=!0,angular.forEach(e.$treeScope.$selecteds,function(n){n=angular.element(n);var t=n.scope();t.$apply(function(){e.$treeScope.$callbacks.dragStart(t.$dragInfo.eventArgs(k,l))})}));return}var at=t.eventObj(n),f={},et={},s={},o={},ot;if(n.preventDefault(),i.getSelection?i.getSelection().removeAllRanges():i.document.selection&&i.document.selection.empty(),a){if(et=t.offset(a),f.left=at.pageX-l.offsetX,f.width=et.width,f.right=f.left+f.width,f.top=at.pageY-l.offsetY,f.height=et.height,f.bottom=f.top+f.height,ot=e.$element.find(v.handleClass),angular.isDefined(ot)&&ot.length>0?(ht=t.offset(ot),s.left=ht.left,s.width=ht.width,s.top=ht.top,s.height=ht.height,s.offset=ot.position().top):(s.left=f.left,s.width=f.width,s.top=f.top),s.right=s.left+s.width,s.bottom=s.top+s.height,angular.isDefined(e.$treeScope.boundTo)&&e.$treeScope.boundTo.length>0?(ct=t.offset(e.$treeScope.boundTo),o.left=ct.left,o.width=ct.width,o.top=ct.top,o.height=ct.height):(o.left=0,o.width=st,o.top=0,o.height=rt),o.right=o.left+o.width,o.bottom=o.top+o.height,f.left<o.left&&(f.left=o.left),f.top<o.top&&(f.top=o.top),f.left>o.right&&(f.left=o.right),f.top>o.bottom&&(f.top=o.bottom),e.$treeScope.lockY&&(f.top=et.top),e.$treeScope.lockX&&(f.left=et.left),a.css({left:f.left+"px",top:f.top+"px"}),wt=window.pageYOffset||i.document.documentElement.scrollTop,bt=wt+(window.innerHeight||i.document.clientHeight||i.document.clientHeight),bt<at.pageY&&bt<=rt&&window.scrollBy(0,10),wt>at.pageY&&window.scrollBy(0,-10),t.positionMoved(n,l,d),d){d=!1;return}if(kt=f.left+f.width/2,dt=f.top+f.height*e.$treeScope.coverage,angular.isFunction(a.hide)?a.hide():(ii=a[0].style.display,a[0].style.display="none"),angular.isFunction(c.hide)?c.hide():(ri=c[0].style.display,c[0].style.display="none"),i.document.elementFromPoint(kt,dt),ui=angular.element(i.document.elementFromPoint(kt,dt)),angular.isFunction(c.show)?c.show():c[0].style.display=ri,angular.isFunction(a.show)?a.show():a[0].style.display=ii,h=ui.scope(),angular.isDefined(h)&&angular.isDefined(h.$nodeScope)?h=h.$nodeScope:angular.isDefined(h)&&angular.isDefined(h.$nodesScope)&&(h=h.$nodesScope),ft=angular.isDefined(h)&&angular.isDefined(h.$treeScope)&&angular.isDefined(h.$treeScope.$treeElement)&&angular.isDefined(h.$treeScope.$treeElement.children())?h:e,fi=ft.$treeScope.$treeElement.children(),lt=angular.isUndefined(e.previousTreeId)||e.previousTreeId.length===0||angular.isUndefined(ft.$treeScope)||e.previousTreeId!==ft.$treeScope.$id,e.previousTreeId=angular.isDefined(ft.$treeScope)?ft.$treeScope.$id:undefined,ei=lt?1:l.dirAx?l.dirX:l.dirY,ni=t.findIntersect(f,fi,e.$treeScope.collideWith,ei,e.$parentNodesScope.horizontal),angular.isDefined(ni)&&(g=angular.element(ni)),l.moving||lt){var yt=angular.element(e.$treeScope.$selecteds[0]).scope().$dragInfo,p=yt.prev(),w=yt.parentNode();if(angular.isDefined(p)&&!p.collapsed&&angular.isDefined(p.$childNodesScope)&&(oi=t.offset(p.$element),f.left>=oi.left+e.$treeScope.spacing-e.$treeScope.spacingThreshold&&(p.accept(e,p.childNodesCount())&&p.$childNodesScope.$element.append(c),angular.forEach(e.$treeScope.$selecteds,function(n,t){var i=angular.element(n).scope();i.moved=i.$dragInfo.moveTo(p.$childNodesScope,p.childNodes(),p.childNodesCount()+t)}),e.asChild=!0)),w=yt.parentNode(),angular.isDefined(w)&&(si=t.offset(w.$element),f.left<=si.left+e.$treeScope.spacingThreshold&&(yt.next()||(w.accept(e,w.index()+1)&&w.$element.after(c),angular.forEach(e.$treeScope.$selecteds,function(n,t){var i=angular.element(n).scope();i.moved=i.$dragInfo.moveTo(w.$parentNodesScope,w.siblings(),w.index()+1+t)}),e.asChild=!1))),angular.isUndefined(g))return;if(r=g.scope(),!r)return;if(vt=!1,gt=!1,r.$type=="uiTree"&&r.dragEnabled&&(vt=r.isEmpty()),r.$type=="uiTreeHandle"&&(r=r.$nodeScope),r.$type!="uiTreeNode"&&!vt)if(r.$type=="uiTree")gt=!0;else return;if(g=r.$element,y=t.offset(g),b&&c.parent()[0]!=b.$element[0]&&(b.resetEmptyElement(),b=undefined),vt)b=r,r.accept(e,0)&&r.place(c),angular.forEach(e.$treeScope.$selecteds,function(n,t){var i=angular.element(n).scope();i.moved=i.$dragInfo.moveTo(r.$parentNodesScope,r.$parentNodesScope.childNodes(),t)});else if(gt)r.accept(e,r.$parentNodesScope.childNodes().length+1)&&r.place(c),angular.forEach(e.$treeScope.$selecteds,function(n,t){var i=angular.element(n).scope();i.moved=i.$dragInfo.moveTo(r.$parentNodesScope,r.$parentNodesScope.childNodes(),r.$parentNodesScope.childNodes().length+1+t)});else if(r.dragEnabled()){if(angular.forEach(e.$treeScope.$selecteds,function(n){var t=angular.element(n).scope();angular.isDefined(t.expandTimeoutOn)&&t.expandTimeoutOn!==r.id&&(u.cancel(t.expandTimeout),delete t.expandTimeout,delete t.expandTimeoutOn,r.$apply(function(){e.$treeScope.$callbacks.expandTimeoutCancel()}))}),r.collapsed&&(nt=r.expandOnHover||r.$parentNodesScope.expandOnHover||r.$treeScope.expandOnHover,nt===!0||angular.isNumber(nt)&&nt===0?r.collapsed=!1:nt!==!1&&angular.isNumber(nt)&&nt>0&&angular.forEach(e.$treeScope.$selecteds,function(n){var t=angular.element(n).scope();angular.isUndefined(t.expandTimeoutOn)&&(t.expandTimeoutOn=r.$id,r.$apply(function(){r.$treeScope.$callbacks.expandTimeoutStart()}),t.expandTimeout=u(function(){r.$apply(function(){r.collapsed=!r.$treeScope.$callbacks.expandTimeoutEnd()})},nt))})),pt=r.hasChild()?t.offset(r.$childNodesScope.$element).height:0,(!e.$parentNodesScope.horizontal&&l.dirY>0||e.$parentNodesScope.horizontal&&l.dirX>0||lt)&&(ti=e.$treeScope.collideWith==="top"?e.$parentNodesScope.horizontal?f.right:f.top:e.$parentNodesScope.horizontal?f.left:f.bottom,hi=e.$parentNodesScope.horizontal?y.left-f.left+y.width*e.$treeScope.coverage:y.top+(y.height-pt)*e.$treeScope.coverage,ti>=hi))if(!r.collapsed&&r.hasChild()||e.asChild){var ut=r.childNodesCount()>0?r.childNodes()[0]:undefined,ci=angular.isDefined(ut)?t.offset(ut.$element):undefined,vi=angular.isDefined(ut)&&ut.hasChild()?t.offset(ut.$childNodesScope.$element).height:0;(angular.isUndefined(ut)||angular.isDefined(ut)&&ti<ci.top+(ci.height-vi)*e.$treeScope.coverage)&&(r.accept(e,0)&&r.$childNodesScope.$element.prepend(c),angular.forEach(e.$treeScope.$selecteds,function(n,t){var u=angular.element(n).scope(),i=r;if(!i.$childNodesScope)while(typeof i.$childNodesScope=="undefined")i=i.$parent;u.moved=u.$dragInfo.moveTo(i.$childNodesScope,i.childNodes(),t)}))}else r.accept(e,r.index()+1)&&g.after(c),angular.forEach(e.$treeScope.$selecteds,function(n,t){var i=angular.element(n).scope();i.moved=i.$dragInfo.moveTo(r.$parentNodesScope,r.siblings(),r.index()+1+t)});((!e.$parentNodesScope.horizontal&&l.dirY<0||e.$parentNodesScope.horizontal&&l.dirX<0)&&(!e.$parentNodesScope.horizontal&&l.distAxY>v.dragUpThreshold||!e.$parentNodesScope.horizontal&&l.distAxX>8)||lt)&&(li=e.$treeScope.collideWith==="top"?e.$parentNodesScope.horizontal?f.left:f.bottom:e.$parentNodesScope.horizontal?f.right:f.top,ai=e.$parentNodesScope.horizontal?y.left-f.left+y.width-y.width*e.$treeScope.coverage:y.top+y.height-pt-(y.height-pt)*e.$treeScope.coverage,li<=ai&&(r.accept(e,r.index())&&g[0].parentNode.insertBefore(c[0],g[0]),angular.forEach(e.$treeScope.$selecteds,function(n,t){var i=angular.element(n).scope();i.moved=i.$dragInfo.moveTo(r.$parentNodesScope,r.siblings(),r.index()+t)})));angular.forEach(e.$treeScope.$selecteds,function(n){var t=angular.element(n).scope(),i;t.moved&&(i=t.$dragInfo.eventArgs(k,l),angular.isDefined(i)&&angular.isDefined(i.dest)&&(angular.isUndefined(t.dragInfoEventsArgs)||angular.isUndefined(t.dragInfoEventsArgs.dest)||!angular.equals(t.dragInfoEventsArgs.dest,i.dest))&&(t.$apply(function(){e.$treeScope.$callbacks.placeholderMove(i)}),t.dragInfoEventsArgs=i))})}}}angular.forEach(e.$treeScope.$selecteds,function(n){var t=angular.element(n).scope();t.$apply(function(){e.$treeScope.$callbacks.dragMove(t.$dragInfo.eventArgs(k,l))})})},ft=function(n,t){var f,i;angular.isDefined(n)&&n.preventDefault();u.cancel(e.expandTimeout);angular.isDefined(a)&&angular.isDefined(n)&&(f=angular.copy(e.$treeScope.$selecteds.length),angular.forEach(e.$treeScope.$selecteds,function(n){var i=angular.element(n).scope(),r;angular.isDefined(i)&&(r=i.$dragInfo.eventArgs(k,l),i.$apply(function(){i.$$apply=e.$treeScope.$callbacks.beforeDrop(r)}),i.$$apply&&!t?(i.$dragInfo.apply(e.$treeScope.copy),e.$treeScope.$apply(function(){e.$treeScope.$callbacks.dropped(r)}),r.dest.nodesScope.$apply(function(){e.$treeScope.$callbacks.droppedInto(r)})):(i.$element.removeClass(v.hiddenClass),i.$apply(function(){e.$treeScope.$callbacks.dragCancel(r)})),i.$apply(function(){e.$treeScope.$callbacks.dragStop(r)}),i.$dragInfo=undefined,i.$apply(function(){delete i.original}))}),angular.isDefined(c)&&(c.remove(),c=undefined),angular.isDefined(p)&&(p.remove(),p=undefined),angular.isDefined(a)&&(a.remove(),a=undefined),e.$treeScope.$selecteds=[]);i=document.body.getAttribute("ui-tree-cursor");i!==null&&(r.find("body").css({cursor:i}),document.body.removeAttribute("ui-tree-cursor"));angular.element(r).unbind("touchend",y);angular.element(r).unbind("touchcancel",y);angular.element(r).unbind("touchmove",nt);angular.element(r).unbind("mouseup",y);angular.element(r).unbind("mousemove",nt);angular.element(r).unbind("mouseleave",et)},wt=function(n){e.dragEnabled()&&yt(n)},nt=function(n){pt(n)},y=function(n){angular.forEach(e.$treeScope.$selecteds,function(n){var i=angular.element(n),t;angular.isDefined(i)&&(t=i.scope(),angular.isDefined(t)&&(t.$$apply=!0))});ft(n)},et=function(n){angular.forEach(e.$treeScope.$selecteds,function(n){var i=angular.element(n),t;angular.isDefined(i)&&(t=i.scope(),angular.isDefined(t)&&(t.$$apply=!1))});ft(n,!0)},bt=function(){o.bind("touchstart mousedown",function(n){e.$treeScope.multiSelect?vt(n):(tt=!0,it=!1,ot=u(function(){wt(n);tt=!1},e.$treeScope.dragDelay))});o.bind("touchend touchcancel mouseup",function(){u.cancel(ot)})},kt=function(){ft();angular.element(r).unbind("keydown").unbind("keyup")};bt();angular.element(r).bind("keydown",function(n){n.keyCode===e.$treeScope.cancelKey&&et(n);angular.isDefined(e.$treeScope.lockXKey)&&n.keyCode===e.$treeScope.lockXKey&&e.$treeScope.$apply(function(){e.$treeScope.lockX=e.$treeScope.$callbacks.lock("X")});angular.isDefined(e.$treeScope.lockYKey)&&n.keyCode===e.$treeScope.lockYKey&&e.$treeScope.$apply(function(){e.$treeScope.lockY=e.$treeScope.$callbacks.lock("Y")});n.keyCode===e.$treeScope.copyKey?e.$treeScope.copy||(e.$treeScope.$apply(function(){e.$treeScope.copy=e.$treeScope.$callbacks.startCopy()}),lt(n)):n.keyCode===e.$treeScope.multiSelectKey&&(e.$treeScope.multiSelect||e.$treeScope.$apply(function(){e.$treeScope.multiSelect=e.$treeScope.$callbacks.startSelect()}))});angular.element(r).bind("keyup",function(n){angular.isDefined(e.$treeScope.lockXKey)&&n.keyCode===e.$treeScope.lockXKey&&e.$treeScope.$apply(function(){e.$treeScope.lockX=!e.$treeScope.$callbacks.unlock("X")});angular.isDefined(e.$treeScope.lockYKey)&&n.keyCode===e.$treeScope.lockYKey&&e.$treeScope.$apply(function(){e.$treeScope.lockY=!e.$treeScope.$callbacks.unlock("Y")});n.keyCode===e.$treeScope.copyKey?e.$treeScope.copy&&(e.$treeScope.$apply(function(){e.$treeScope.copy=!e.$treeScope.$callbacks.endCopy()}),lt(n)):n.keyCode===e.$treeScope.multiSelectKey&&e.$treeScope.multiSelect&&e.$treeScope.$apply(function(){e.$treeScope.multiSelect=!e.$treeScope.$callbacks.endSelect()})});e.$on("$destroy",kt)}}}])}(),function(){"use strict";angular.module("ui.tree").directive("uiTreeHandle",["treeConfig",function(n){return{require:"^uiTreeNode",restrict:"A",scope:!0,controller:"TreeHandleController",link:function(t,i,r,u){var f={};angular.extend(f,n);f.handleClass&&i.addClass(f.handleClass);t!=u.scope&&(t.$nodeScope=u.scope,u.scope.$handleScope=t)}}}])}();
/*
//# sourceMappingURL=angular-ui-tree.min.js.map
*/