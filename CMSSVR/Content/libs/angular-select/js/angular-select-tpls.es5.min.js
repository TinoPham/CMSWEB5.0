"use strict";angular.module("ui.multiselect",["multiselect.tpl.html"]).factory("optionParser",["$parse",function(n){var t=/^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+(.*)$/;return{parse:function(i){var r=i.match(t);if(!r)throw new Error("Expected typeahead specification in form of '_modelValue_ (as _label_)? for _item_ in _collection_' but got '"+i+"'.");return{itemName:r[3],source:n(r[4]),viewMapper:n(r[2]||r[1]),modelMapper:n(r[1])}},numtoRGB:function(n){n>>>=0;var t=n&255,i=(n&65280)>>>8,r=(n&16711680)>>>16;return"rgb("+[r,i,t].join(",")+")"}}}]).directive("multiselect",["$parse","$document","$compile","$interpolate","$timeout","optionParser","cmsBase","AppDefine",function(n,t,i,r,u,f,e,o){return{restrict:"E",require:"ngModel",link:function(t,s,h,c){function k(){var n,i,r;if(l.items.length=0,n=a.source(t),angular.isDefined(n)&&n!==null){for(i=0;i<n.length;i++)r={},r[a.itemName]=n[i],l.items.push({label:a.viewMapper(r),model:n[i],checked:!1});angular.isDefined(c.$modelValue)&&(g(c.$modelValue),d())}}function d(){if(rt(c.$modelValue))return l.header=h.msHeader||e.translateSvc.getTranslate(o.Resx.HEADER_SELECT);if(v)l.header=h.msSelected?r(h.msSelected)(l):c.$modelValue.length+" "+e.translateSvc.getTranslate(o.Resx.HEADER_SELECTED);else{var n={};n[a.itemName]=c.$modelValue;l.header=a.viewMapper(n)}}function rt(n){if(!n)return!0;if(n.length&&n.length>0)return!1;for(var t in n)if(n[t])return!1;return!0}function ut(n){n.checked||(l.uncheckAll(),n.checked=!n.checked);y(!1)}function ft(n){n.checked=!n.checked;y(!0);l.$emit("checkedchange",{item:n,name:h.name})}function y(n){var t;n?(t=[],angular.forEach(l.items,function(n){n.checked&&t.push(n.model)})):angular.forEach(l.items,function(n){if(n.checked)return t=n.model,!1});c.$setViewValue(t)}function g(n){angular.isArray(n)?angular.forEach(n,function(n){angular.forEach(l.items,function(t){angular.equals(t.model,n)&&(t.checked=!0)})}):angular.forEach(l.items,function(t){if(angular.equals(t.model,n))return t.checked=!0,!1})}var nt=h.options,a=f.parse(nt),v=h.multiple?!0:!1,p=!1,l=t.$new(),tt=h.change||angular.noop,it=h.hideIcon?!0:!1,w,b;l.isAlertTypes=h.isalerttypes?!0:!1;l.items=[];l.header=e.translateSvc.getTranslate(o.Resx.HEADER_SELECT);l.multiple=v;l.disabled=!1;l.hideIcon=it;l.filterText="";l.autocomplete=h.autocomplete!==undefined?!0:!1;t.$on("$destroy",function(){l.$destroy();u.cancel(w)});b=angular.element("<multiselect-popup><\/multiselect-popup>");(h.required||h.ngRequired)&&(p=!0);h.$observe("required",function(n){p=n});l.$watch(function(){return n(h.disabled)(t)},function(n){l.disabled=n});l.$watch(function(){return n(h.multiple)(t)},function(n){v=n||!1});l.$watch(function(){return a.source(t)},function(n){angular.isDefined(n)&&k()},!0);l.$watch(function(){return c.$modelValue},function(n){angular.isDefined(n)&&(g(n),l.$eval(tt));d();c.$setValidity("required",l.valid())},!0);l.$watch("filterText",function(n,t){n!==t&&l.autocomplete&&(u.cancel(w),w=u(function(){l.$emit("filterdata",{filter:n,name:h.name})},700))});k();s.append(i(b)(l));l.valid=function(){if(!p)return!0;var n=c.$modelValue;return angular.isArray(n)&&n.length>0||!angular.isArray(n)&&n!=null};l.checkAll=function(){v&&(angular.forEach(l.items,function(n){n.checked=!0}),y(!0),l.$emit("checkall",h.name))};l.uncheckAll=function(){angular.forEach(l.items,function(n){n.checked=!1});y(!0);l.$emit("uncheckall",h.name)};l.Save_ShowHide_Alert=function(){var n=[];angular.forEach(l.items,function(t){t.checked&&n.push(t.model)});l.$emit("SaveShowHideAlert",n)};l.select=function(n){v===!1?(ut(n),l.toggleSelect()):ft(n)};l.jqueryScrollbarOptions={onScroll:function(n){n.scroll<=0||Math.ceil(n.scroll)>=Math.ceil(n.maxScroll)&&l.$emit("loadmoredata",h.name)}};l.toggleLoadData=function(){l.$emit("loadmoredata",h.name)}}}}]).directive("multiselectPopup",["$document","optionParser",function(n,t){return{restrict:"E",scope:!1,replace:!0,templateUrl:"multiselect.tpl.html",link:function(i,r){function u(t){f(t.target,r.find(t.target.tagName))||(r.removeClass("open"),n.unbind("click",u),i.$apply())}i.isVisible=!1;i.toggleSelect=function(){r.hasClass("open")?(r.removeClass("open"),n.unbind("click",u)):(r.addClass("open"),n.bind("click",u),i.focus())};i.focus=function(){var n=r.find("input")[0];n.focus()};var f=function(n,t){for(var i=0;i<t.length;i++)if(n==t[i])return!0;return!1};i.numtoRGB=function(n){return t.numtoRGB(n)}}}}]);angular.module("multiselect.tpl.html",[]).run(["$templateCache",function(n){n.put("multiselect.tpl.html",'<div class="btn-group" ng-click="toggleLoadData()">\n  <span class="form-control dropdown-toggle" ng-click="toggleSelect()" ng-disabled="disabled" ng-class="{\'error\': !valid()}">\n    <div class="select-header">{{header | translate}}<\/div> <span class="caret pull-right"><\/span>\n  <\/span>\n  <ul class="dropdown-menu">\n    <li class="input-search">\n      <input ng-show="!autocomplete" class="form-control input-sm" type="text" ng-model="searchText.label" autofocus="autofocus" placeholder="Filter" />\n      <input ng-show="autocomplete" class="form-control input-sm" type="text" ng-model="filterText" autofocus="autofocus" placeholder="Filter" />\n    <\/li>\n    <li ng-show="multiple" role="presentation" class="multiple-controls">\n      <button class="btn btn-link btn-xs" ng-click="checkAll()" type="button"><i class="glyphicon glyphicon-ok"><\/i>{{\'CHECK_ALL\' | translate}}<\/button>\n      <button class="btn btn-link btn-xs" ng-click="uncheckAll()" type="button"><i class="glyphicon glyphicon-remove"><\/i>{{\'UNCHECK_ALL\' | translate}}<\/button>\n      <button ng-if="isAlertTypes" class="btn btn-link btn-xs" ng-click="Save_ShowHide_Alert()" type="button"><i class="glyphicon glyphicon-save"><\/i>{{\'BTN_DONE\' | translate}}<\/button>\n    <\/li>\n    <li>\n\t\t\t<ul class="dropdown-menu-list scroll-body scrollbar-dynamic" data-jquery-scrollbar="jqueryScrollbarOptions"> \n\t\t\t\t<li ng-repeat="i in items | filter:searchText" title="">\n\t\t\t\t\t<div ng-class="{\'checkbox checkbox-default\': !hideIcon}" ng-if="multiple" ng-click="select(i); focus()"> \n\t\t\t\t\t<input type="checkbox" ng-checked="i.checked" ng-hide="hideIcon"> \n\t\t\t\t\t<label class="i-name">{{i.label | translate}}<\/label> \n\t\t\t\t<\/div>\t\t\t\t<div ng-class="{\'radio radio-default\': !hideIcon}" ng-if="!multiple" ng-click="select(i); focus()"> \n\t\t\t\t\t<input type="radio" ng-checked="i.checked" ng-hide="hideIcon"> \n\t\t\t\t\t<label class="i-name"> \n\t\t\t\t\t\t<span ng-if="i.model.Color !== undefined" class="i-color" ng-style="{\'border-color\': numtoRGB(i.model.Color) } "><\/span> \n\t\t\t\t\t\t{{i.label | translate}} \n\t\t\t\t\t<\/label> \n\t\t\t\t<\/div>\t\t\t\t<div style="clear: both;"><\/div>\n\t\t\t<\/li> \n\t\t<\/ul> \n    <\/li>\n\t\t\t<li class="btn-close-select-dropdown"> \n               <div ng-click=\'toggleSelect()\'>{{\'BTN_CLOSE\' | translate}}<\/div>\t\t\t<\/li> \n  <\/ul>\n<\/div>')}]);